function Preloader(t,e,i){for(var n={},o=0,s=t.length,r=0;s>r;r++){var a=new Image;a.onload=function(){o++,o===s&&(e.images=n,e.preLoaded=!0,i())},a.src=t[r],n[t[r]]=a}}function Controls(){}function _getKeyByValue(t){for(var e in keys)if(keys.hasOwnProperty(e)&&keys[e]===t)return e;return" "!=String.fromCharCode(t)?String.fromCharCode(t):void 0}function _setKey(t,e){var i=_getKeyByValue(t);i&&(pushedKeys[i]=e)}function Sprite(t){this.image=t.image,this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this.delay=t.delay,this.loop=t.lopp||!1,this.delayCounter=0,this.frames=t.frames,this.frameIndex=0,this.animated=!1}function _renderImage(t,e){CTX.drawImage(t.image,e,0,t.width,t.height,t.x,t.y,t.width,t.height)}function Maned(t){this.canvas=document.querySelector(t.className),this.ctx=this.canvas.getContext("2d"),CTX=this.ctx,this.width=t.width,this.height=t.height,this.background=t.background||"#fff",this.statuses={gameTime:0},this.states={},this.events={},this.lastTick,this.dt,this.images=[],this.preLoaded=!1,this.canvas.focus()}function _init(t){_renderBackground(t),t.events.start&&t.events.start(),_gameLoop(t)}function _gameLoop(t){var e=Date.now();(e-t.lastTick)/1e3;window.requestAnimationFrame(function(){_gameLoop(t)}),t.clearCanvas(),_renderBackground(t),t.events.update&&t.events.update()}function _renderBackground(t){t.ctx.fillStyle="#000",t.ctx.fillRect(0,0,t.width,t.height)}var pushedKeys={},keys={SPACE:32,ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_DOWN:40};Controls.isPressedKey=function(t){return pushedKeys[t]},window.addEventListener("keydown",function(t){_setKey(t.keyCode,!0)}),window.addEventListener("keyup",function(t){_setKey(t.keyCode,!1)}),window.addEventListener("blur",function(t){pushedKeys={}}),Sprite.prototype.render=function(){_renderImage(this,0)},Sprite.prototype.update=function(){this.frameIndex===this.frames-1?this.loop?this.frameIndex=0:this.animated=!0:this.delayCounter===this.delay&&(this.frameIndex++,this.delayCounter=0);var t=this.frameIndex*this.width;_renderImage(this,t),this.delayCounter++},function(){function t(){}t.isCollided=function(t,e){return t.x+t.width>=e.x&&t.x<=e.x+e.width&&t.y>=e.y&&t.y<=e.y+e.height},window.Collision=t}(),function(){function t(){}t.text=function(t,e,i,n){CTX.font=n.font,CTX.fillStyle=n.color,n.textAlign&&(CTX.textAlign=n.textAlign),CTX.fillText(t,e,i)},window.Util=t}();var CTX;Maned.prototype.init=function(){this.preLoaded?_init(this):this.events.preload&&this.events.preload()},Maned.prototype.bg=function(){_renderBackground(this)},Maned.prototype.on=function(t,e){"function"==typeof e&&(this.events[t]=e)},Maned.prototype.clearCanvas=function(){this.ctx.clearRect(0,0,this.width,this.height)},Maned.prototype.preload=function(t){var e=this;Preloader(t,this,function(){e.init()})},Maned.prototype.controls=window.Controls,Maned.prototype.sprite=window.Sprite,Maned.prototype.collision=window.Collision,Maned.prototype.text=window.Util.text;